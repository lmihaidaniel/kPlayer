/*! kmlplayer.js - v0.3.1 */
var kmlPlayer=function(){"use strict";function e(e){return e.charAt(0).toUpperCase()+e.slice(1)}function t(){}function n(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(){this._events=new t,this._eventsCount=0}function r(){var e=0,t=0;this.save=function(){e=window.pageXOffset||0,t=window.pageYOffset||0},this.restore=function(){window.scrollTo(e,t)}}function A(e){for(var t=e.querySelectorAll("source"),n=0;n<t.length;n++)g.remove(t[n]);e.setAttribute("src","data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAAGm1kYXQAAAGzABAHAAABthBgUYI9t+8AAAMNbW9vdgAAAGxtdmhkAAAAAMXMvvrFzL76AAAD6AAAACoAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAABhpb2RzAAAAABCAgIAHAE/////+/wAAAiF0cmFrAAAAXHRraGQAAAAPxcy++sXMvvoAAAABAAAAAAAAACoAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAgAAAAIAAAAAAG9bWRpYQAAACBtZGhkAAAAAMXMvvrFzL76AAAAGAAAAAEVxwAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAABaG1pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAShzdGJsAAAAxHN0c2QAAAAAAAAAAQAAALRtcDR2AAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAgACABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAAXmVzZHMAAAAAA4CAgE0AAQAEgICAPyARAAAAAAMNQAAAAAAFgICALQAAAbABAAABtYkTAAABAAAAASAAxI2IAMUARAEUQwAAAbJMYXZjNTMuMzUuMAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAAABAAAAAQAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAASAAAAAQAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYHVkdGEAAABYbWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAraWxzdAAAACOpdG9vAAAAG2RhdGEAAAABAAAAAExhdmY1My4yMS4x"),e.load()}function o(e,t){switch(t){case"video/webm":return!(!e.canPlayType||!e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/no/,""));case"video/mp4":return!(!e.canPlayType||!e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"').replace(/no/,""));case"video/ogg":return!(!e.canPlayType||!e.canPlayType('video/ogg; codecs="theora"').replace(/no/,""))}}function s(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=N();i&&!function(){var r=!1,A=!1,o=!1,s=function(){A=!0},a={visible:function(){},hidden:function(){}},u=function(){a={visible:function(){},hidden:function(){}},r=!1,A=!1,P.removeEventListener(H,c,!1),e.removeEventListener("playing",s)},c=function(){r&&(P[k]?(A&&!e.paused&&(e.pause(),o=!0),a.hidden()):(o&&e.paused&&(e.play(),o=!1),a.visible()))},l=function(t){i&&(P.removeEventListener(H,c,!1),e.removeEventListener("playing",s),a.visible=t.onVisible||a.visible,a.hidden=t.onHidden||a.hidden,r=!0,P.addEventListener(H,c,!1),e.addEventListener("playing",s))};a.visible=n.onVisible||a.visible,a.hidden=n.onHidden||a.hidden,r=!0,P.addEventListener(H,c,!1),e.addEventListener("playing",s),t.init=l,t.destroy=u,t.on=function(e,t){e in a&&(a[e]=t)},t.enabled=function(e){return"boolean"==typeof e&&(r=e),r}}()}function a(e){e&&(this.disable=function(){e.addEventListener("contextmenu",R)},this.enable=function(){e.removeEventListener("contextmenu",R)})}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},c=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},l=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},d=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},f=function(){var e=function t(e,n){if(n){var i=Array.isArray(n),r=i&&[]||{};return i?(e=e||[],r=r.concat(e),n.forEach(function(n,i){"undefined"==typeof r[i]?r[i]=n:"object"===("undefined"==typeof n?"undefined":u(n))?r[i]=t(e[i],n):e.indexOf(n)===-1&&r.push(n)})):(e&&"object"===("undefined"==typeof e?"undefined":u(e))&&Object.keys(e).forEach(function(t){r[t]=e[t]}),Object.keys(n).forEach(function(i){"object"===u(n[i])&&n[i]&&e[i]?r[i]=t(e[i],n[i]):r[i]=n[i]})),r}return e||[]};return e}(),h=function(e){return new RegExp("(^|\\s+)"+e+"(\\s+|$)")},p=void 0,m=void 0,y=void 0,v=void 0;"classList"in document.documentElement?(p=function(e,t){return e.classList.contains(t)},m=function(e,t){t=t.split(" ");for(var n in t)e.classList.add(t[n])},y=function(e,t){e.classList.remove(t)}):(p=function(e,t){return h(t).test(e.className)},m=function(e,t){p(e,t)||(e.className=e.className+" "+t)},y=function(e,t){e.className=e.className.replace(h(t)," ")}),v=function(e,t){var n=p(e,t)?y:m;n(e,t)};var g={"class":{has:p,add:m,remove:y,toggle:v},createElement:function(e,t){var n=document.createElement(e);for(var i in t)n.setAttribute(i,t[i]);return n},remove:function(e){e&&e.parentNode.removeChild(e)},wrap:function(e,t){e.length||(e=[e]);for(var n=e.length-1;n>=0;n--){var i=n>0?t.cloneNode(!0):t,r=e[n],A=r.parentNode,o=r.nextSibling;return i.appendChild(r),o?A.insertBefore(i,o):A.appendChild(i),i}}},b=Object.prototype.hasOwnProperty,w="~";Object.create&&(t.prototype=Object.create(null),(new t).__proto__||(w=!1)),i.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)b.call(e,t)&&n.push(w?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},i.prototype.listeners=function(e,t){var n=w?w+e:e,i=this._events[n];if(t)return!!i;if(!i)return[];if(i.fn)return[i.fn];for(var r=0,A=i.length,o=new Array(A);r<A;r++)o[r]=i[r].fn;return o},i.prototype.emit=function(e,t,n,i,r,A){var o=w?w+e:e;if(!this._events[o])return!1;var s,a,u=this._events[o],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,i),!0;case 5:return u.fn.call(u.context,t,n,i,r),!0;case 6:return u.fn.call(u.context,t,n,i,r,A),!0}for(a=1,s=new Array(c-1);a<c;a++)s[a-1]=arguments[a];u.fn.apply(u.context,s)}else{var l,d=u.length;for(a=0;a<d;a++)switch(u[a].once&&this.removeListener(e,u[a].fn,void 0,!0),c){case 1:u[a].fn.call(u[a].context);break;case 2:u[a].fn.call(u[a].context,t);break;case 3:u[a].fn.call(u[a].context,t,n);break;case 4:u[a].fn.call(u[a].context,t,n,i);break;default:if(!s)for(l=1,s=new Array(c-1);l<c;l++)s[l-1]=arguments[l];u[a].fn.apply(u[a].context,s)}}return!0},i.prototype.on=function(e,t,i){var r=new n(t,i||this),A=w?w+e:e;return this._events[A]?this._events[A].fn?this._events[A]=[this._events[A],r]:this._events[A].push(r):(this._events[A]=r,this._eventsCount++),this},i.prototype.once=function(e,t,i){var r=new n(t,i||this,(!0)),A=w?w+e:e;return this._events[A]?this._events[A].fn?this._events[A]=[this._events[A],r]:this._events[A].push(r):(this._events[A]=r,this._eventsCount++),this},i.prototype.removeListener=function(e,n,i,r){var A=w?w+e:e;if(!this._events[A])return this;if(!n)return 0===--this._eventsCount?this._events=new t:delete this._events[A],this;var o=this._events[A];if(o.fn)o.fn!==n||r&&!o.once||i&&o.context!==i||(0===--this._eventsCount?this._events=new t:delete this._events[A]);else{for(var s=0,a=[],u=o.length;s<u;s++)(o[s].fn!==n||r&&!o[s].once||i&&o[s].context!==i)&&a.push(o[s]);a.length?this._events[A]=1===a.length?a[0]:a:0===--this._eventsCount?this._events=new t:delete this._events[A]}return this},i.prototype.removeAllListeners=function(e){var n;return e?(n=w?w+e:e,this._events[n]&&(0===--this._eventsCount?this._events=new t:delete this._events[n])):(this._events=new t,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prototype.setMaxListeners=function(){return this},i.prefixed=w;var E=!1,_="webkit moz o ms khtml".split(" "),S="";if("undefined"!=typeof document.cancelFullScreen)E=!0;else for(var x=0,C=_.length;x<C;x++){if(S=_[x],"undefined"!=typeof document[S+"CancelFullScreen"]){E=!0;break}if("undefined"!=typeof document.msExitFullscreen&&document.msFullscreenEnabled){S="ms",E=!0;break}}var k,H,L=function(e){function t(){c(this,t);var n=d(this,e.call(this));return n.scrollPosition=new r,E||(n._fullscreenElement=null,n.fullscreenElementStyle={}),n}return l(t,e),t.prototype.isFullScreen=function(e){if(E)switch("undefined"==typeof e&&(e=this.wrapper),S){case"":return document.fullscreenElement==e;case"moz":return document.mozFullScreenElement==e;default:return document[S+"FullscreenElement"]==e}return!1},t.prototype.requestFullScreen=function(e){if("undefined"==typeof e&&(e=this.wrapper),E)return""===S?e.requestFullScreen():e[S+("ms"==S?"RequestFullscreen":"RequestFullScreen")]();if(!this.isFullScreen()){this.scrollPosition.save();window.getComputedStyle(e);this.fullscreenElementStyle.position=e.style.position||"",this.fullscreenElementStyle.margin=e.style.margin||"",this.fullscreenElementStyle.top=e.style.top||"",this.fullscreenElementStyle.left=e.style.left||"",this.fullscreenElementStyle.width=e.style.width||"",this.fullscreenElementStyle.height=e.style.height||"",this.fullscreenElementStyle.zIndex=e.style.zIndex||"",e.style.position="absolute",e.style.top=e.style.left=0,e.style.margin=0,e.style.width=e.style.height="100%",e.style.zIndex=2147483647,this._fullscreenElement=e,this.isFullScreen=function(){return!0}}},t.prototype.cancelFullScreen=function(){if(E)return""===S?document.cancelFullScreen():document[S+("ms"==S?"ExitFullscreen":"CancelFullScreen")]();if(this.isFullScreen()){for(var e in this.fullscreenElementStyle)this._fullscreenElement.style[e]=this.fullscreenElementStyle[e];this._fullscreenElement=null,this.isFullScreen=function(){return!1},this.scrollPosition.restore()}},t.prototype.toggleFullscreen=function(e){var t=!this.isFullScreen();t?this.requestFullScreen(e):this.cancelFullScreen()},t.prototype.fullscreenElement=function(){return E?""===S?document.fullscreenElement:document[S+"FullscreenElement"]:this._fullscreenElement},t}(i),F=["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","playing","pause","error","seeking","emptied","seeked","ratechange","suspend"],O=function(e){function t(n){c(this,t);var i=d(this,e.call(this));return i.media=n,F.forEach(function(e){n.addEventListener(e,function(){i.emit(e)})}),i.canPlay={mp4:o(n,"video/mp4"),webm:o(n,"video/webm"),ogg:o(n,"video/ogg")},i}return l(t,e),t.prototype.autoplay=function(e){return"boolean"==typeof e&&(this.media.autoplay=e),this.media.autoplay},t.prototype.buffered=function(){return this.media.buffered},t.prototype.controls=function(e){return"boolean"==typeof e&&(this.media.controls=e),this.media.controls},t.prototype.crossorigin=function(e){return"use-credentials"===e?(this.media.crossOrigin="use-credentials",e):e?(this.media.crossOrigin="anonymous","anonymous"):(e===!1&&(this.media.crossOrigin=null),this.media.crossOrigin)},t.prototype.loop=function(e){return"boolean"==typeof e&&(this.media.loop=e),this.media.loop},t.prototype.muted=function(e){return"boolean"==typeof e&&(this.media.muted=e),this.media.muted},t.prototype.mute=function(){this.muted(!0)},t.prototype.unmute=function(){this.muted(!1)},t.prototype.toggleMute=function(){return this.muted(!this.muted())},t.prototype.played=function(){return this.media.played},t.prototype.preload=function(e){return"metadata"===e||"meta"===e?(this.media.preload="metadata","metadata"):e?(this.media.preload="auto","auto"):e===!1?(this.media.preload="none","none"):this.media.preload},t.prototype.poster=function(e){return void 0!==e&&(this.media.poster=e),this.media.poster},t.prototype.src=function(e){if(void 0!==e)if(A(this.media),e instanceof Array){var t=0;for(e.length;t+=1;){if("video/mp4"===e[t].type&&this.canPlay.mp4)return this.media.src=e[t].src;if("video/webm"===e[t].type&&this.canPlay.webm)return this.media.src=e[t].src;if("video/ogg"===e[t].type&&this.canPlay.ogg)return this.media.src=e[t].src}}else e.src&&e.type?this.media.src=e.src:this.media.src=e;return this.media.currentSrc},t.prototype.play=function(){this.media.play()},t.prototype.pause=function(){this.media.pause()},t.prototype.togglePlay=function(){this.media.paused?this.play():this.pause()},t.prototype.currentTime=function(e){return null===e||isNaN(e)?this.media.currentTime:(e=parseFloat(e),e>this.media.duration&&(e=this.media.duration),e<0&&(e=0),this.media.currentTime=e,e)},t.prototype.seek=function(e){return this.currentTime(e)},t.prototype.load=function(e){void 0!==e&&this.src(e),this.media.load()},t.prototype.duration=function(){return this.media.duration},t.prototype.volume=function(e){return null===e||isNaN(e)?this.media.volume:(e=parseFloat(e),e>1&&(e=1),e<0&&(e=0),this.media.volume=e,e)},t}(L),B=function(){var e=0,t=function(t,n){void 0!==n&&(e=n);var i={wrapperWidth:t.offsetWidth,wrapperHeight:t.offsetHeight,scale:e||t.width/t.height,width:0,height:0,offsetX:0,offsetY:0};return i.wrapperScale=i.wrapperWidth/i.wrapperHeight,i.wrapperScale>i.scale?(i.height=i.wrapperHeight,i.width=i.scale*i.height,i.offsetX=(i.wrapperWidth-i.width)/2):(i.width=i.wrapperWidth,i.height=i.width/i.scale,i.offsetY=(i.wrapperHeight-i.height)/2),i};return t}(),P=document||{};"undefined"!=typeof P.hidden?(k="hidden",H="visibilitychange"):"undefined"!=typeof P.mozHidden?(k="mozHidden",H="mozvisibilitychange"):"undefined"!=typeof P.msHidden?(k="msHidden",H="msvisibilitychange"):"undefined"!=typeof P.webkitHidden&&(k="webkitHidden",H="webkitvisibilitychange");var N=function(){return!("undefined"==typeof P[k])},R=function(e){return e.stopPropagation(),e.preventDefault(),!1},W=document||{},j=function(e){var t=!0,n=!0,i=null,r=e,A=function(e){if(t){if(r.parentNode.focus(),32==e.keyCode&&(r.paused?r.play():r.pause()),n){if(37==e.keyCode)return void(r.currentTime=r.currentTime-5);if(39==e.keyCode)return void(r.currentTime=r.currentTime+5)}if(38==e.keyCode){var i=r.volume;return i+=.1,i>1&&(i=1),void(r.volume=i)}if(40==e.keyCode){var A=r.volume;return A-=.1,A<0&&(A=0),void(r.volume=A)}}},o=function(e){};this.enabled=function(e){return void 0===e?t:void(t=e)},this.seekEnabled=function(e){return void 0===e?n:void(n=e)},this.init=function(){t=!0,i=null,n=!0,W.body.addEventListener("keydown",A.bind(this),!1),W.body.addEventListener("keyup",o.bind(this),!1)},this.destroy=function(){t=!1,i=null,n=!0,W.body.removeEventListener("keydown",A),W.body.removeEventListener("keyup",o)},this.init()},z=function(){function e(e){var i=["get","post","put","delete"];return e=e||{},e.baseUrl=e.baseUrl||"",e.method&&e.url?n(e.method,e.baseUrl+e.url,t(e.data),e):i.reduce(function(i,r){return i[r]=function(i,A){return n(r,e.baseUrl+i,t(A),e)},i},{})}function t(e){return e||null}function n(e,t,n,r){var o=["then","catch","always"],a=o.reduce(function(e,t){return e[t]=function(n){return e[t]=n,e},e},{}),u=new XMLHttpRequest;return u.open(e,t,!0),u.withCredentials=r.hasOwnProperty("withCredentials"),i(u,r.headers),u.addEventListener("readystatechange",A(a,u),!1),u.send(s(n)),a.abort=function(){return u.abort()},a}function i(e,t){t=t||{},r(t)||(t["Content-Type"]="application/x-www-form-urlencoded"),Object.keys(t).forEach(function(n){t[n]&&e.setRequestHeader(n,t[n])})}function r(e){return Object.keys(e).some(function(e){return"content-type"===e.toLowerCase()})}function A(e,t){return function n(){t.readyState===t.DONE&&(t.removeEventListener("readystatechange",n,!1),e.always.apply(e,o(t)),t.status>=200&&t.status<300?e.then.apply(e,o(t)):e["catch"].apply(e,o(t)))}}function o(e){var t;try{t=JSON.parse(e.responseText)}catch(n){t=e.responseText}return[t,e]}function s(e){return a(e)?u(e):e}function a(e){return"[object Object]"===Object.prototype.toString.call(e)}function u(e){return Object.keys(e).reduce(function(t,n){var i=t?t+"&":"";return i+c(n)+"="+c(e[n])},"")}function c(e){return encodeURIComponent(e)}return e}(),T={width:960,height:540},G=function(t){function n(i,r,A){c(this,n);var o=d(this,t.call(this,i));o[r]=f(T,r),g["class"].add(i,"kml"+e(i.nodeName.toLowerCase())),o.wrapper=g.wrap(o.media,g.createElement("div",{"class":"kmlPlayer"})),o.defaultWidth(o[r].width),o.defaultHeight(o[r].height),o.pageVisibility=new s(i,{onHidden:function(){}}),o.contextMenu=new a(i),o.externalControls=new j(i);for(var u in A)o.on(u,A[u],o);return o}return l(n,t),n.prototype.ajax=function(e){return z(e)},n.prototype.defaultWidth=function(e){return this.media.videoWidth?(this.media.width=this.media.videoWidth,this.media.videoWidth):(isNaN(e)||(e=parseFloat(e),this.media.width=e),this.media.width)},n.prototype.defaultHeight=function(e){return this.media.videoHeight?(this.media.height=this.media.videoHeight,this.media.videoHeight):(isNaN(e)||(e=parseFloat(e),this.media.height=e),this.media.height)},n.prototype.scale=function(){return this.defaultWidth()/this.defaultHeight()},n.prototype.bounds=function(e){var t=B(this.media);return void 0!==t[e]?t[e]:t},n.prototype.width=function(){return this.bounds("width")},n.prototype.height=function(){return this.bounds("height")},n.prototype.offsetX=function(){return this.bounds("offsetX")},n.prototype.offsetY=function(){return this.bounds("offsetY")},n.prototype.wrapperHeight=function(){return this.media.offsetHeight},n.prototype.wrapperWidth=function(){return this.media.offsetWidth},n.prototype.wrapperScale=function(){return this.media.offsetWidth/this.media.offsetHeight},n.prototype.addClass=function(e){g["class"].add(this.wrapper,e)},n.prototype.removeClass=function(e){"kmlPlayer"!==e&&g["class"].remove(this.wrapper,e)},n.prototype.toggleClass=function(e){"kmlPlayer"!==e&&g["class"].toggle(this.wrapper,e)},n}(O);return G}();