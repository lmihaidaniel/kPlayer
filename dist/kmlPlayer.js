/*! kmlplayer.js - v0.3.1 */
var kmlPlayer=function(){"use strict";function e(e){return e.charAt(0).toUpperCase()+e.slice(1)}function t(e){if(void 0===e||null===e)return!1;var t=!1;return e.indexOf&&e.indexOf("%")>-1&&(t=parseFloat(e)),t}function n(e,t){var n;return function(){clearTimeout(n),n=setTimeout(e,t)}}function i(e,t,n){var i=!1,o=!1;return"px"!=e.units&&(e.units="em"),e.min!==!1&&e.ratio!==!1&&(i=e.ratio*t/1e3,i<e.min&&(i=e.min),"px"==e.units&&(i=Math.ceil(i)),!isNaN(e.lineHeight)&&e.lineHeight&&(o=i*e.lineHeight,o<1&&(o=1),o=+o.toFixed(3)+e.units),i=+i.toFixed(3)+e.units),n&&(i&&(n.style.fontSize=i),o&&(n.style.lineHeight=o)),{fontSize:i,lineHeight:o}}function o(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(){this._events=new o,this._eventsCount=0}function A(){var e=0,t=0;this.save=function(){e=window.pageXOffset||0,t=window.pageYOffset||0},this.restore=function(){window.scrollTo(e,t)}}function a(e){for(var t=x.selectAll("source",e),n=0;n<t.length;n++)x.removeElement(t[n]);e.setAttribute("src","data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAAGm1kYXQAAAGzABAHAAABthBgUYI9t+8AAAMNbW9vdgAAAGxtdmhkAAAAAMXMvvrFzL76AAAD6AAAACoAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAABhpb2RzAAAAABCAgIAHAE/////+/wAAAiF0cmFrAAAAXHRraGQAAAAPxcy++sXMvvoAAAABAAAAAAAAACoAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAgAAAAIAAAAAAG9bWRpYQAAACBtZGhkAAAAAMXMvvrFzL76AAAAGAAAAAEVxwAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAABaG1pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAShzdGJsAAAAxHN0c2QAAAAAAAAAAQAAALRtcDR2AAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAgACABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAAXmVzZHMAAAAAA4CAgE0AAQAEgICAPyARAAAAAAMNQAAAAAAFgICALQAAAbABAAABtYkTAAABAAAAASAAxI2IAMUARAEUQwAAAbJMYXZjNTMuMzUuMAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAAABAAAAAQAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAASAAAAAQAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYHVkdGEAAABYbWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAraWxzdAAAACOpdG9vAAAAG2RhdGEAAAABAAAAAExhdmY1My4yMS4x"),e.load()}function l(e,t){switch(t){case"video/webm":return!(!e.canPlayType||!e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/no/,""));case"video/mp4":return!(!e.canPlayType||!e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"').replace(/no/,""));case"video/ogg":return!(!e.canPlayType||!e.canPlayType('video/ogg; codecs="theora"').replace(/no/,""))}}function u(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=Q();i&&!function(){var o=!1,r=!1,s=!1,A=function(){r=!0},a={visible:function(){},hidden:function(){}},l=function(){a={visible:function(){},hidden:function(){}},o=!1,r=!1,G.removeEventListener(Y,u,!1),e.removeEventListener("playing",A)},u=function(){o&&(G[B]?(r&&!e.paused&&(e.pause(),s=!0),a.hidden()):(s&&e.paused&&(e.play(),s=!1),a.visible()))},c=function(t){i&&(G.removeEventListener(Y,u,!1),e.removeEventListener("playing",A),a.visible=t.onVisible||a.visible,a.hidden=t.onHidden||a.hidden,o=!0,G.addEventListener(Y,u,!1),e.addEventListener("playing",A))};a.visible=n.onVisible||a.visible,a.hidden=n.onHidden||a.hidden,o=!0,G.addEventListener(Y,u,!1),e.addEventListener("playing",A),t.init=c,t.destroy=l,t.on=function(e,t){e in a&&(a[e]=t)},t.enabled=function(e){return"boolean"==typeof e&&(o=e),o}}()}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},f=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},d=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},h=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},p=function(){var e=function t(e,n){if(n){var i=Array.isArray(n),o=i&&[]||{};return i?(e=e||[],o=o.concat(e),n.forEach(function(n,i){"undefined"==typeof o[i]?o[i]=n:"object"===("undefined"==typeof n?"undefined":c(n))?o[i]=t(e[i],n):e.indexOf(n)===-1&&o.push(n)})):(e&&"object"===("undefined"==typeof e?"undefined":c(e))&&Object.keys(e).forEach(function(t){o[t]=e[t]}),Object.keys(n).forEach(function(i){"object"===c(n[i])&&n[i]&&e[i]?o[i]=t(e[i],n[i]):o[i]=n[i]})),o}return e||[]};return e}(),y=function(e){return new RegExp("(^|\\s+)"+e+"(\\s+|$)")},m=void 0,v=void 0,g=void 0,w=void 0;"classList"in document.documentElement?(m=function(e,t){return e.classList.contains(t)},v=function(e,t){t=t.split(" ");for(var n in t)e.classList.add(t[n])},g=function(e,t){e.classList.remove(t)}):(m=function(e,t){return y(t).test(e.className)},v=function(e,t){m(e,t)||(e.className=e.className+" "+t)},g=function(e,t){e.className=e.className.replace(y(t)," ")}),w=function(e,t){var n=m(e,t)?g:v;n(e,t)};var b=function(e){var t="Webkit Moz ms O".split(" "),n=document.documentElement.style;if(void 0!==n[e])return e;e=e.charAt(0).toUpperCase()+e.substr(1);for(var i=0;i<t.length;i++)if(void 0!==n[t[i]+e])return t[i]+e},x={stylePrefix:{transform:b("transform"),perspective:b("perspective"),backfaceVisibility:b("backfaceVisibility")},triggerWebkitHardwareAcceleration:function(e){this.stylePrefix.backfaceVisibility&&this.stylePrefix.perspective&&(e.style[this.stylePrefix.perspective]="1000px",e.style[this.stylePrefix.backfaceVisibility]="hidden")},transform:function(e,t){e.style[this.stylePrefix.transform]=t},selectAll:function(e,t){return(t||document).querySelectorAll(e)},select:function(e,t){return(t||document).querySelector(e)},hasClass:m,addClass:v,removeClass:g,toggleClass:w,autoLineHeight:function(e){var t=e.offsetHeight+"px";return e.style.lineHeight=t,t},createElement:function(e,t){var n=document.createElement(e);for(var i in t)n.setAttribute(i,t[i]);return n},emptyElement:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},replaceElement:function(e,t){e.parentNode.replaceChild(t,e)},removeElement:function(e){e.parentNode.removeChild(e)},insertAfter:function(e,t){t.parentNode.insertBefore(e,t.nextSibling)},insertBefore:function(e,t){t.parentNode.insertBefore(e,t)},getTextContent:function(e){return e.textContent||e.innerText},wrap:function(e,t){e.length||(e=[e]);for(var n=e.length-1;n>=0;n--){var i=n>0?t.cloneNode(!0):t,o=e[n],r=o.parentNode,s=o.nextSibling;return i.appendChild(o),s?r.insertBefore(i,s):r.appendChild(i),i}}},E=function(e,t,o){var r=!1,s=function(){n(function(){i(t,o.width(),e)},100)()};this.update=function(n){if(void 0!==n)return t||(t={ratio:1,min:1,lineHeight:!1}),t=p(t,n),i(t,o.width(),e)},this.enabled=function(e){return"boolean"==typeof e&&t&&(r=e),r},o.on&&o.on("resize",s)},_={x:0,y:0,width:"100%",height:"100%",fontSize:null,lineHeight:null,offsetX:0,offsetY:0,originPoint:"topLeft",visible:!1,transform:{x:null,y:null},translate:!0},C=function(e,n,i){var o={x:0,y:0,width:"100%",height:"100%",fontSize:null,lineHeight:null},r=0,s=0,A=0,a=0,l=null,u=p(_,n),c=!1,f=function(){if(c&&l&&l.nodeType){if(null!==o.width&&(l.style.width=o.width+"px"),null!==o.height&&(l.style.height=o.height+"px"),x.stylePrefix.transform&&u.translate){var e="";null!=o.x&&null!=o.y?(e="translate("+o.x+"px,"+o.y+"px)",l.style.left="auto",l.style.right="auto",l.style.bottom="auto",l.style.top="auto"):(null!=o.x&&(l.style.left="auto",l.style.right="auto",e="translateX("+o.x+"px)"),null!=o.y&&(l.style.bottom="auto",l.style.top="auto",e="translateY("+o.y+"px)")),x.transform(l,e)}else null!=o.x&&null!=o.y?(l.style.left=o.x+"px",l.style.top=o.y+"px"):(null!=o.x&&(l.style.left=o.x+"px"),null!=o.y&&(l.style.top=o.y+"px"));u.fontSize!==o.fontSize&&(l.style.fontSize=o.fontSize=u.fontSize),u.lineHeight!==o.lineHeight&&(l.style.lineHeight=o.lineHeight=u.lineHeight)}},d=function(){var n=i.width(),l=i.height(),c=i.offsetX(),d=i.offsetY();if(r!=n||s!=l||c!=A||d!=a){r=n,s=l,A=c,a=d;var h=e(),p=t(u.width);p?o.width=h.width*p/100:null!=u.width&&(o.width=h.width*h.scale);var y=t(u.height);if(y?o.height=h.height*y/100:null!=u.height&&(o.height=h.height*h.scale),null!=u.x){var m=t(u.x);m?o.x=h.offsetX+h.width*m/100:o.x=h.offsetX+u.x*h.scale;var v=t(u.transform.x);v&&(o.x+=v*o.width/100),u.offsetX&&(o.x+=u.offsetX)}if(null!=u.y){var g=t(u.y);g?o.y=h.offsetY+h.height*g/100:o.y=h.offsetY+u.y*h.scale;var w=t(u.transform.y);w&&(o.y+=w*o.width/100),u.offsetY&&(o.y+=u.offsetY)}f()}};this.applyTo=function(e){return e&&e.nodeType&&(l=e,d()),l};var h=function(){d()};this.data=function(){return o},this.settings=function(e){return u=p(u,e),d(),u},this.enabled=function(e){return"boolean"==typeof e&&(c=e,e&&h()),c},i.on&&i.on("resize",h)},S={x:0,y:0,width:0,height:0},H=function(e,n){var i=e.defaultWidth()||e.width||0,o=e.defaultHeight()||e.height||0,r=p(S,n),s=t(r.width);s||(s=r.width/i*100);var A=t(r.height);A||(A=r.height/o*100);var a=t(r.x);a||(a=r.x/i*100);var l=t(r.y);return l||(l=r.y/o*100),{x:a,y:l,width:s,height:A}},k=function J(e){f(this,J),this.el=x.createElement("div",{style:"position:absolute; pointer-events: none;"});var t=new C(function(){return{offsetX:e.offsetX(),offsetY:e.offsetY(),width:e.width(),height:e.height(),scale:e.width()/e.defaultWidth(),scaleY:e.width()/e.defaultHeight()}},{},e);t.applyTo(this.el),t.enabled(!0),e.wrapper.appendChild(this.el),this.add=function(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];n.nodeType||(n=x.createElement("div")),x.addClass(n,"kmlContainer"),n.style.position="absolute",n.style.pointerEvents="all";var i=function(){var i=new H(e,t);n.style.width=i.width+"%",n.style.height=i.height+"%",x.stylePrefix.transform?x.transform(n,"translate("+100/i.width*i.x+"%,"+100/i.height*i.y+"%)"):(n.style.top=i.x+"%",n.style.left=i.y+"%")};i(),this.el.appendChild(n),e.on("resize",i)}},L=Object.prototype.hasOwnProperty,z="~";Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(z=!1)),s.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)L.call(e,t)&&n.push(z?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},s.prototype.listeners=function(e,t){var n=z?z+e:e,i=this._events[n];if(t)return!!i;if(!i)return[];if(i.fn)return[i.fn];for(var o=0,r=i.length,s=new Array(r);o<r;o++)s[o]=i[o].fn;return s},s.prototype.emit=function(e,t,n,i,o,r){var s=z?z+e:e;if(!this._events[s])return!1;var A,a,l=this._events[s],u=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),u){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,i),!0;case 5:return l.fn.call(l.context,t,n,i,o),!0;case 6:return l.fn.call(l.context,t,n,i,o,r),!0}for(a=1,A=new Array(u-1);a<u;a++)A[a-1]=arguments[a];l.fn.apply(l.context,A)}else{var c,f=l.length;for(a=0;a<f;a++)switch(l[a].once&&this.removeListener(e,l[a].fn,void 0,!0),u){case 1:l[a].fn.call(l[a].context);break;case 2:l[a].fn.call(l[a].context,t);break;case 3:l[a].fn.call(l[a].context,t,n);break;case 4:l[a].fn.call(l[a].context,t,n,i);break;default:if(!A)for(c=1,A=new Array(u-1);c<u;c++)A[c-1]=arguments[c];l[a].fn.apply(l[a].context,A)}}return!0},s.prototype.on=function(e,t,n){var i=new r(t,n||this),o=z?z+e:e;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],i]:this._events[o].push(i):(this._events[o]=i,this._eventsCount++),this},s.prototype.once=function(e,t,n){var i=new r(t,n||this,(!0)),o=z?z+e:e;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],i]:this._events[o].push(i):(this._events[o]=i,this._eventsCount++),this},s.prototype.removeListener=function(e,t,n,i){var r=z?z+e:e;if(!this._events[r])return this;if(!t)return 0===--this._eventsCount?this._events=new o:delete this._events[r],this;var s=this._events[r];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||(0===--this._eventsCount?this._events=new o:delete this._events[r]);else{for(var A=0,a=[],l=s.length;A<l;A++)(s[A].fn!==t||i&&!s[A].once||n&&s[A].context!==n)&&a.push(s[A]);a.length?this._events[r]=1===a.length?a[0]:a:0===--this._eventsCount?this._events=new o:delete this._events[r]}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=z?z+e:e,this._events[t]&&(0===--this._eventsCount?this._events=new o:delete this._events[t])):(this._events=new o,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prototype.setMaxListeners=function(){return this},s.prefixed=z;var F=!1,P="webkit moz o ms khtml".split(" "),O="";if("undefined"!=typeof document.cancelFullScreen)F=!0;else for(var W=0,N=P.length;W<N;W++){if(O=P[W],"undefined"!=typeof document[O+"CancelFullScreen"]){F=!0;break}if("undefined"!=typeof document.msExitFullscreen&&document.msFullscreenEnabled){O="ms",F=!0;break}}var T=""===O?"fullscreenchange":O+"fullscreenchange";T=T.toLowerCase();var B,Y,X=function(e){function t(){f(this,t);var n=h(this,e.call(this));if(n.scrollPosition=new A,F){var i=function(){n.isFullScreen()||setTimeout(n.scrollPosition.restore,100)};document.addEventListener(T,i,!1)}else n._fullscreenElement=null,n.fullscreenElementStyle={};return n}return d(t,e),t.prototype.onFullscreenChange=function(e){this.media.addEventListener(T,function(e){return e.preventDefault(),e.stopPropagation,!1},!0)},t.prototype.isFullScreen=function(e){if(F)switch("undefined"==typeof e&&(e=this.wrapper),O){case"":return document.fullscreenElement==e;case"moz":return document.mozFullScreenElement==e;default:return document[O+"FullscreenElement"]==e}return!1},t.prototype.requestFullScreen=function(e){if("undefined"==typeof e&&(e=this.wrapper),F)return this.scrollPosition.save(),""===O?e.requestFullScreen():e[O+("ms"==O?"RequestFullscreen":"RequestFullScreen")]();if(!this.isFullScreen()){this.scrollPosition.save();var t=window.getComputedStyle(e);this.fullscreenElementStyle.position=t.position||"",this.fullscreenElementStyle.margin=t.margin||"",this.fullscreenElementStyle.top=t.top||"",this.fullscreenElementStyle.left=t.left||"",this.fullscreenElementStyle.width=t.width||"",this.fullscreenElementStyle.height=t.height||"",this.fullscreenElementStyle.zIndex=t.zIndex||"",this.fullscreenElementStyle.maxWidth=t.maxWidth||"",this.fullscreenElementStyle.maxHeight=t.maxHeight||"",e.style.position="absolute",e.style.top=e.style.left=0,e.style.margin=0,e.style.maxWidth=e.style.maxHeight=e.style.width=e.style.height="100%",e.style.zIndex=2147483647,this._fullscreenElement=e,this.emit("resize"),this.isFullScreen=function(){return!0}}},t.prototype.cancelFullScreen=function(){if(F)return""===O?document.cancelFullScreen():document[O+("ms"==O?"ExitFullscreen":"CancelFullScreen")]();if(this.isFullScreen()){for(var e in this.fullscreenElementStyle)this._fullscreenElement.style[e]=this.fullscreenElementStyle[e];this._fullscreenElement=null,this.isFullScreen=function(){return!1},this.emit("resize"),this.scrollPosition.restore()}},t.prototype.toggleFullScreen=function(e){var t=!this.isFullScreen();t?this.requestFullScreen(e):this.cancelFullScreen()},t.prototype.fullscreenElement=function(){return F?""===O?document.fullscreenElement:document[O+"FullscreenElement"]:this._fullscreenElement},t}(s),R=["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","playing","pause","error","seeking","emptied","seeked","ratechange","suspend"],j=function(e){function t(n){f(this,t);var i=h(this,e.call(this));return i.media=n,R.forEach(function(e){n.addEventListener(e,function(){i.emit(e)})}),i.canPlay={mp4:l(n,"video/mp4"),webm:l(n,"video/webm"),ogg:l(n,"video/ogg")},i}return d(t,e),t.prototype.autoplay=function(e){return"boolean"==typeof e&&(this.media.autoplay=e),this.media.autoplay},t.prototype.buffered=function(){return this.media.buffered},t.prototype.nativeControls=function(e){return"boolean"==typeof e&&(this.media.controls=e),this.media.controls},t.prototype.crossorigin=function(e){return"use-credentials"===e?(this.media.crossOrigin="use-credentials",e):e?(this.media.crossOrigin="anonymous","anonymous"):(e===!1&&(this.media.crossOrigin=null),this.media.crossOrigin)},t.prototype.loop=function(e){return"boolean"==typeof e&&(this.media.loop=e),this.media.loop},t.prototype.muted=function(e){return"boolean"==typeof e&&(this.media.muted=e),this.media.muted},t.prototype.mute=function(){this.muted(!0)},t.prototype.unmute=function(){this.muted(!1)},t.prototype.toggleMute=function(){return this.muted(!this.muted())},t.prototype.played=function(){return this.media.played},t.prototype.preload=function(e){return"metadata"===e||"meta"===e?(this.media.preload="metadata","metadata"):e?(this.media.preload="auto","auto"):e===!1?(this.media.preload="none","none"):this.media.preload},t.prototype.poster=function(e){return void 0!==e&&(this.media.poster=e),this.media.poster},t.prototype.src=function(e){if(void 0!==e)if(a(this.media),e instanceof Array){var t=0;for(e.length;t+=1;){if("video/mp4"===e[t].type&&this.canPlay.mp4)return this.media.src=e[t].src;if("video/webm"===e[t].type&&this.canPlay.webm)return this.media.src=e[t].src;if("video/ogg"===e[t].type&&this.canPlay.ogg)return this.media.src=e[t].src}}else e.src&&e.type?this.media.src=e.src:this.media.src=e;return this.media.currentSrc},t.prototype.play=function(){this.media.play()},t.prototype.pause=function(){this.media.pause()},t.prototype.togglePlay=function(){this.media.paused?this.play():this.pause()},t.prototype.currentTime=function(e){return null===e||isNaN(e)?this.media.currentTime:(e=parseFloat(e),e>this.media.duration&&(e=this.media.duration),e<0&&(e=0),this.media.currentTime=e,e)},t.prototype.seek=function(e){return this.currentTime(e)},t.prototype.load=function(e){void 0!==e&&this.src(e),this.media.load()},t.prototype.duration=function(){return this.media.duration},t.prototype.volume=function(e){return null===e||isNaN(e)?this.media.volume:(e=parseFloat(e),e>1&&(e=1),e<0&&(e=0),this.media.volume=e,e)},t}(X),M=function(){var e=0,t=function(t,n){void 0!==n&&(e=n);var i={wrapperWidth:t.offsetWidth,wrapperHeight:t.offsetHeight,scale:e||t.width/t.height,width:0,height:0,offsetX:0,offsetY:0};return i.wrapperScale=i.wrapperWidth/i.wrapperHeight,i.wrapperScale>i.scale?(i.height=i.wrapperHeight,i.width=i.scale*i.height,i.offsetX=(i.wrapperWidth-i.width)/2):(i.width=i.wrapperWidth,i.height=i.width/i.scale,i.offsetY=(i.wrapperHeight-i.height)/2),i};return t}(),G=document||{};"undefined"!=typeof G.hidden?(B="hidden",Y="visibilitychange"):"undefined"!=typeof G.mozHidden?(B="mozHidden",Y="mozvisibilitychange"):"undefined"!=typeof G.msHidden?(B="msHidden",Y="msvisibilitychange"):"undefined"!=typeof G.webkitHidden&&(B="webkitHidden",Y="webkitvisibilitychange");var Q=function(){return!("undefined"==typeof G[B])},I=document||{},U=function(e){var t=!0,n=!0,i=null,o=e,r=function(e){if(t){if(o.parentNode.focus(),32==e.keyCode&&(o.paused?o.play():o.pause()),n){if(37==e.keyCode)return void(o.currentTime=o.currentTime-5);if(39==e.keyCode)return void(o.currentTime=o.currentTime+5)}if(38==e.keyCode){var i=o.volume;return i+=.1,i>1&&(i=1),void(o.volume=i)}if(40==e.keyCode){var r=o.volume;return r-=.1,r<0&&(r=0),void(o.volume=r)}}},s=function(e){};this.enabled=function(e){return void 0===e?t:void(t=e)},this.seekEnabled=function(e){return void 0===e?n:void(n=e)},this.init=function(){t=!0,i=null,n=!0,I.body.addEventListener("keydown",r.bind(this),!1),I.body.addEventListener("keyup",s.bind(this),!1)},this.destroy=function(){t=!1,i=null,n=!0,I.body.removeEventListener("keydown",r),I.body.removeEventListener("keyup",s)},this.init()},V=function(){function e(e){var i=["get","post","put","delete"];return e=e||{},e.baseUrl=e.baseUrl||"",e.method&&e.url?n(e.method,e.baseUrl+e.url,t(e.data),e):i.reduce(function(i,o){return i[o]=function(i,r){return n(o,e.baseUrl+i,t(r),e)},i},{})}function t(e){return e||null}function n(e,t,n,o){var s=["then","catch","always"],a=s.reduce(function(e,t){return e[t]=function(n){return e[t]=n,e},e},{}),l=new XMLHttpRequest;return l.open(e,t,!0),l.withCredentials=o.hasOwnProperty("withCredentials"),i(l,o.headers),l.addEventListener("readystatechange",r(a,l),!1),l.send(A(n)),a.abort=function(){return l.abort()},a}function i(e,t){t=t||{},o(t)||(t["Content-Type"]="application/x-www-form-urlencoded"),Object.keys(t).forEach(function(n){t[n]&&e.setRequestHeader(n,t[n])})}function o(e){return Object.keys(e).some(function(e){return"content-type"===e.toLowerCase()})}function r(e,t){return function n(){t.readyState===t.DONE&&(t.removeEventListener("readystatechange",n,!1),e.always.apply(e,s(t)),t.status>=200&&t.status<300?e.then.apply(e,s(t)):e["catch"].apply(e,s(t)))}}function s(e){var t;try{t=JSON.parse(e.responseText)}catch(n){t=e.responseText}return[t,e]}function A(e){return a(e)?l(e):e}function a(e){return"[object Object]"===Object.prototype.toString.call(e)}function l(e){return Object.keys(e).reduce(function(t,n){var i=t?t+"&":"";return i+u(n)+"="+u(e[n])},"")}function u(e){return encodeURIComponent(e)}return e}(),q=function(e){return e.stopPropagation(),e.preventDefault(),!1},Z={defaultWidth:920,defaultHeight:520,autoplay:!1,loop:!1,controls:!1,font:{ratio:1,min:.5,units:"em"}},D=function(t){function n(i,o,r,s){f(this,n);var A=h(this,t.call(this,i));A.__settings=p(Z,o),x.addClass(i,"kml"+e(i.nodeName.toLowerCase())),A.wrapper=x.wrap(A.media,x.createElement("div",{"class":"kmlPlayer"})),x.triggerWebkitHardwareAcceleration(A.wrapper);for(var a in A.__settings){if(A[a]){if("autoplay"===a&&A.__settings[a]){A.play();continue}A[a](A.__settings[a])}"controls"===a&&"native"===A.__settings[a]&&A.nativeControls(!0)}A.pageVisibility=new u(i),A.externalControls=new U(i),A.containers=new k(A),"boolean"==typeof A.__settings.font&&A.__settings.font&&(A.__settings.font=Z.font),A.autoFont=new E(A.wrapper,A.__settings.font,A),A.__settings.font&&A.autoFont.enabled(!0);for(var l in r)A.on(l,r[l],A);return A.on("loadedmetadata",function(){A.media.width==A.media.videoWidth&&A.media.height==A.media.videoHeight||(A.defaultWidth(),A.defaultHeight(),A.emit("resize"))}),window.addEventListener("resize",function(){A.emit("resize")},!1),"function"==typeof s&&s.bind(A)(),A}return d(n,t),n.prototype.contextMenu=function(e){"boolean"==typeof e&&(e?this.media.removeEventListener("contextmenu",q):this.media.addEventListener("contextmenu",q))},n.prototype.ajax=function(e){return V(e)},n.prototype.defaultWidth=function(e){return this.media.videoWidth?(this.media.width=this.media.videoWidth,this.media.videoWidth):(isNaN(e)||(e=parseFloat(e),this.media.width=e),this.media.width)},n.prototype.defaultHeight=function(e){return this.media.videoHeight?(this.media.height=this.media.videoHeight,this.media.videoHeight):(isNaN(e)||(e=parseFloat(e),this.media.height=e),this.media.height)},n.prototype.scale=function(){return this.defaultWidth()/this.defaultHeight()},n.prototype.bounds=function(e){var t=M(this.media);return void 0!==t[e]?t[e]:t},n.prototype.width=function(){return this.bounds("width")},n.prototype.height=function(){return this.bounds("height")},n.prototype.offsetX=function(){return this.bounds("offsetX")},n.prototype.offsetY=function(){return this.bounds("offsetY")},n.prototype.wrapperHeight=function(){return this.media.offsetHeight},n.prototype.wrapperWidth=function(){return this.media.offsetWidth},n.prototype.wrapperScale=function(){return this.media.offsetWidth/this.media.offsetHeight},n.prototype.addClass=function(e,t){return void 0!==t?void x.addClass(t,e):void x.addClass(this.wrapper,e)},n.prototype.removeClass=function(e,t){return void 0!==t?void x.removeClass(t,e):void("kmlPlayer"!==e&&x.removeClass(this.wrapper,e))},n.prototype.toggleClass=function(e,t){return void 0!==t?void x.toggleClass(t,e):void("kmlPlayer"!==e&&x.toggleClass(this.wrapper,e))},n}(j);return window.onerror=function(e,t,n,i){alert(n+":"+i+"-"+e)},D}();